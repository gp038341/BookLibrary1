@page "/addnew"


@inject IBookRepository Repository;
@inject NavigationManager Navigation;

<PageTitle>
	Add New Book
</PageTitle>

<div class="row justify-content-center">
	<div class="col-6">
		<EditForm method="post" FormName="AddBookForm" Model="Book" OnValidSubmit="AddBook" autocomplete="off">
			<h3>
				Add New Book
			</h3>
			<div class="mb-3">
				<label for="title" class="form-label">
					Title
				</label>
				<InputText id="title" @bind-Value="Book.Title" class="form-control" shadow-none></InputText>
			</div>
			<div class="mb-3">
				<label for="author" class="form-label">
					Author
				</label>
				<InputText id="author" @bind-Value="Book.Author" class="form-control" shadow-none></InputText>
			</div>
			<div class="mb-3">
				<label for="pub-date" class="form-label">
					Publication Date
				</label>
				<InputDate id="pub-date" @bind-Value="Book.PublishedDate" class="form-control" shadow-none></InputDate>
			</div>
			<div class="mb-3">
				<label for="genre" class="form-label">
					Genre
				</label>
				<InputSelect id="genre" @bind-Value="Book.Genre" class="form-control shadow-none">
					<option value="0">
						Select Genre
					</option>
					@foreach (var genre in Enum.GetValues(typeof(Genre)))
					{
						<option value="@genre">
							@genre.ToString()
						</option>
					}
				</InputSelect>
			</div>
			<DataAnnotationsValidator/>
			<ValidationSummary />
		</EditForm>
	</div>
</div>

@code {
	[SupplyParameterFromForm]
	public Book Book { get; set; } = new();
	private async Task AddBook()
	{
		await Repository.AddAsync(Book);
		Navigation.NavigateTo("/");
	}

}
